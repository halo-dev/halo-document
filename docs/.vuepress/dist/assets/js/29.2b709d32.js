(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{282:function(a,t,s){"use strict";s.r(t);var n=s(9),e=Object(n.a)({},function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"配置域名访问"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置域名访问","aria-hidden":"true"}},[a._v("#")]),a._v(" 配置域名访问")]),a._v(" "),s("h2",{attrs:{id:"使用-nginx-进行反向代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-nginx-进行反向代理","aria-hidden":"true"}},[a._v("#")]),a._v(" 使用 Nginx 进行反向代理")]),a._v(" "),s("h3",{attrs:{id:"安装-nginx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-nginx","aria-hidden":"true"}},[a._v("#")]),a._v(" 安装 Nginx")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 添加 Nginx 源")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rpm")]),a._v(" -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 安装 Nginx")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" -y nginx\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 Nginx")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl start nginx.service\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置开机自启 Nginx")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("enable")]),a._v(" nginx.service\n")])])]),s("h3",{attrs:{id:"配置-nginx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-nginx","aria-hidden":"true"}},[a._v("#")]),a._v(" 配置 Nginx")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 下载 Halo 官方的 Nginx 配置模板")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" -o /etc/nginx/conf.d/halo.conf --create-dirs https://raw.githubusercontent.com/halo-dev/halo-common/master/nginx.conf\n")])])]),s("p",[a._v("下载完成之后，我们还需要对其进行修改")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用 vim 编辑 halo.conf")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/nginx/conf.d/halo.conf\n")])])]),s("p",[a._v("打开之后我们可以看到")]),a._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("server")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("listen")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("80")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("server_name")]),a._v(" example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("com www"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("location")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("proxy_set_header")]),a._v(" HOST "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$host")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("proxy_set_header")]),a._v(" X"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("Forwarded"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("Proto "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$scheme")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("proxy_set_header")]),a._v(" X"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("Real"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("IP "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$remote_addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("proxy_set_header")]),a._v(" X"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("Forwarded"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("For "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$proxy_add_x_forwarded_for")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("proxy_pass")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("http")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v(".0")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v(".1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8090")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("blockquote",[s("p",[a._v("注意：请把 "),s("code",[a._v("example.com")]),a._v(" 改为自己的域名。")])]),a._v(" "),s("p",[a._v("修改完成之后")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 检查配置是否有误")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" nginx -t\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 重载 Nginx 配置")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" nginx -s reload\n")])])]),s("h3",{attrs:{id:"配置-ssl-证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-ssl-证书","aria-hidden":"true"}},[a._v("#")]),a._v(" 配置 SSL 证书")]),a._v(" "),s("p",[a._v("在这里我只演示如果自动申请证书，如果你自己准备了证书，请查阅相关教程。")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 安装 certbot 以及 certbot nginx 插件")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" certbot python2-certbot-nginx -y\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 执行配置，中途会询问你的邮箱，如实填写即可")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" certbot --nginx\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 自动续约")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" certbot renew --dry-run\n")])])]),s("p",[a._v("到这里，关于 Nginx 的配置也就完成了，现在你可以访问一下自己的域名，并进行 Halo 的初始化了。")]),a._v(" "),s("div",[s("AdSense-Doc",{attrs:{"ad-client":"ca-pub-5271828906478846","ad-slot":"2656935500","ad-style":"display:block; text-align:center;","ad-format":"fluid"}})],1),a._v(" "),s("h2",{attrs:{id:"或者使用-caddy-进行反向代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#或者使用-caddy-进行反向代理","aria-hidden":"true"}},[a._v("#")]),a._v(" 或者使用 Caddy 进行反向代理")]),a._v(" "),s("p",[s("code",[a._v("Caddy")]),a._v(" 是一款使用 "),s("code",[a._v("Go")]),a._v(" 语言开发的 "),s("code",[a._v("Web")]),a._v(" 服务器。其配置更为简洁，并可以自动申请及配置 SSL 证书（推荐）。")]),a._v(" "),s("h3",{attrs:{id:"安装-caddy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-caddy","aria-hidden":"true"}},[a._v("#")]),a._v(" 安装 Caddy")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 安装 Caddy 软件包")]),a._v("\nyum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" caddy -y\n")])])]),s("h3",{attrs:{id:"配置-caddy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-caddy","aria-hidden":"true"}},[a._v("#")]),a._v(" 配置 Caddy")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 下载 Halo 官方的 Caddy 配置模板")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" -o /etc/caddy/conf.d/Caddyfile.conf --create-dirs https://raw.githubusercontent.com/halo-dev/halo-common/master/Caddyfile\n")])])]),s("p",[a._v("下载完成之后，我们还需要对其进行修改。")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用 vim 编辑 Caddyfile")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/caddy/conf.d/Caddyfile.conf\n")])])]),s("p",[a._v("打开之后我们可以看到")]),a._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("https")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("www"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("simple"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("com "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("gzip")]),a._v("\n tls xxxx@xxx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("xx\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("proxy")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v(" localhost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("port "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  transparent\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("ol",[s("li",[a._v("请把 "),s("code",[a._v("https://www.simple.com")]),a._v(" 改为自己的域名。")]),a._v(" "),s("li",[s("code",[a._v("tls")]),a._v(" 后面的 "),s("code",[a._v("xxxx@xxx.xx")]),a._v(" 改为自己的邮箱地址，这是用于自动申请 SSL 证书用的。需要注意的是，不需要你自己配置 SSL 证书，而且会自动帮你续签。")]),a._v(" "),s("li",[s("code",[a._v("localhost:port")]),a._v(" 请将 "),s("code",[a._v("port")]),a._v(" 修改为 Halo 的运行端口，默认为 8090。")])]),a._v(" "),s("p",[a._v("修改完成之后启动 "),s("code",[a._v("Caddy")]),a._v(" 服务即可。")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 开启自启 Caddy 服务")]),a._v("\nsystemctl "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("enable")]),a._v(" caddy\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 Caddy")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" caddy start\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 停止运行 Caddy")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" caddy stop\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 重启 Caddy")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" caddy restart\n")])])]),s("h3",{attrs:{id:"进阶设置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#进阶设置","aria-hidden":"true"}},[a._v("#")]),a._v(" 进阶设置")]),a._v(" "),s("p",[a._v("多网址重定向到主网址，比如访问 "),s("code",[a._v("simple.com")]),a._v(" 跳转到 "),s("code",[a._v("www.simple.com")]),a._v(" 应该怎么做呢？")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用 vim 编辑 Caddyfile")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/caddy/conf.d/Caddyfile.conf\n")])])]),s("p",[a._v("打开之后我们在原有的基础上添加以下配置")]),a._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("https")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("simple"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("com "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  redir "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("https")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("www"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("simple"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("p",[a._v("将 "),s("code",[a._v("https://simple.com")]),a._v(" 和 "),s("code",[a._v("https://www.simple.com{url}")]),a._v(" 修改为自己需要的网址就行了，比如我要求访问 "),s("code",[a._v("ryanc.cc")]),a._v(" 跳转到 "),s("code",[a._v("www.ryanc.cc")]),a._v("，完整的配置如下：")]),a._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("http")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("ryanc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("cc "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  redir "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("https")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("www"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("ryanc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("cc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("https")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("www"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("ryanc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("cc "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("gzip")]),a._v("\n  tls i@ryanc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("cc\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("proxy")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v(" localhost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8090")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    transparent\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("p",[a._v("最后我们重启 "),s("code",[a._v("Caddy")]),a._v(" 即可。")]),a._v(" "),s("p",[a._v("到这里，关于 "),s("code",[a._v("Caddy")]),a._v(" 反向代理的配置也就完成了，现在你可以访问一下自己的域名，并进行 "),s("code",[a._v("Halo")]),a._v(" 的初始化了。")]),a._v(" "),s("div",[s("AdSense-Doc",{attrs:{"ad-client":"ca-pub-5271828906478846","ad-slot":"2656935500","ad-style":"display:block; text-align:center;","ad-format":"fluid"}})],1)])},[],!1,null,null,null);t.default=e.exports}}]);